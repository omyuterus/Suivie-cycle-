<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mon suivi de cycle ğŸŒ™</title>
  <style>
    :root{
      --bg:#fbf7f4; --card:#ffffff; --text:#1f2937; --muted:#6b7280;
      --accent:#a74d5e; --green:#93b087; --dark:#244135; --border:#eadfd7;
      --shadow: 0 10px 30px rgba(31,41,55,.08); --radius:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family: system-ui, -apple-system, sans-serif;
      background: radial-gradient(1200px 600px at 10% 10%, rgba(167,77,94,.10), transparent 60%), var(--bg);
      color:var(--text); line-height: 1.5;
    }
    header, main{ max-width:1120px; margin:0 auto; padding:16px; }
    main{ display:grid; grid-template-columns: 1.1fr .9fr; gap:20px; }
    @media (max-width: 1000px){ main{ grid-template-columns:1fr; } }
    .card{ background:var(--card); border:1px solid var(--border); border-radius:var(--radius); box-shadow:var(--shadow); padding:20px; margin-bottom:16px; }
    .card h2{ margin-top:0; color:var(--dark); font-size:18px; border-bottom:1px solid var(--border); padding-bottom:8px;}
    .note{ background: rgba(147,176,135,.10); border:1px dashed var(--green); padding:12px; border-radius:14px; font-size:13px; margin:10px 0; }
    .note2{ background: rgba(167,77,94,.08); border:1px dashed var(--accent); padding:12px; border-radius:14px; font-size:13px; margin:10px 0; }
    
    /* EncadrÃ© de conseil dynamique */
    #magicAdvice{ background: #fff9db; border: 2px solid #fab005; padding:15px; border-radius:14px; font-size:14px; display:none; margin-bottom:15px; animation: fadeIn 0.5s; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    label{ font-size:13px; color:var(--muted); display:block; margin-bottom:5px; font-weight: bold; margin-top:15px; }
    input, select, textarea{ width:100%; padding:12px; border:1px solid var(--border); border-radius:14px; outline:none; font-size:14px; margin-bottom:10px; }
    .chips{ display:flex; flex-wrap:wrap; gap:8px; margin-bottom:10px; }
    .chip{ display:flex; align-items:center; gap:8px; padding:8px 12px; border:1px solid var(--border); border-radius:999px; background:#fff; cursor:pointer; font-size:13px; transition:0.2s; }
    .chip input{ accent-color: var(--accent); width: auto; margin:0; }
    .scale{ display:grid; grid-template-columns: repeat(11, 1fr); gap:4px; }
    .scale input{ appearance:none; height:35px; border:1px solid var(--border); border-radius:8px; cursor:pointer; display:flex; align-items:center; justify-content:center; }
    .scale input:checked{ border:2px solid var(--accent); background: rgba(167,77,94,.1); }
    .scale input::before{ content: attr(title); font-size:11px; }
    button{ border:none; padding:12px 14px; border-radius:14px; cursor:pointer; font-weight:800; font-size:14px; transition:0.2s; }
    .btn-primary{ background:var(--accent); color:#fff; width: 100%; }
    .btn-secondary{ background:rgba(147,176,135,.2); color:var(--dark); margin-top:5px; width:100%; }
    .btn-ghost{ background:transparent; border:1px solid var(--border); color:var(--muted); width:100%; margin-top:10px;}
    .entry{ border:1px solid var(--border); border-radius:15px; padding:12px; margin-bottom:10px; background: rgba(255,255,255,0.5); }
    .strong{ font-weight:bold; color:var(--dark); }
  </style>
</head>
<body>

<header>
  <h1>Mon suivi de cycle ğŸŒ™</h1>
  <p style="color:var(--muted); font-size:14px;">Carnet personnel : comprendre son corps et ses rythmes.</p>
</header>

<main>
  <section>
    <div class="card">
      <h2>ğŸ“… Dates & Ramadan</h2>
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
        <div><label>Mois</label><input type="month" id="mainMonth"></div>
        <div><label>Pseudo</label><input type="text" id="nickname" placeholder="ğŸŒ¸"></div>
      </div>
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
        <div><label>DÃ©but rÃ¨gles</label><input type="date" id="startDate"></div>
        <div><label>Fin rÃ¨gles</label><input type="date" id="endDate"></div>
      </div>
      <div class="note2">
        <label><input type="checkbox" id="ramadanMode" style="width:auto;"> Suivi Ramadan (jours Ã  rattraper)</label>
        <div id="ramadanFields" style="display:none; margin-top:10px;">
          <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
            <div><label>Total Ã  faire</label><input type="number" id="ramTotal"></div>
            <div><label>DÃ©jÃ  faits</label><input type="number" id="ramDone"></div>
          </div>
        </div>
      </div>
      <button class="btn-secondary" onclick="saveMonth()">Enregistrer les dates du mois</button>
    </div>

    <div class="card">
      <h2>â• Ma note du jour</h2>
      <label>Date du jour</label>
      <input type="date" id="entryDate">
      
      <label>Comment te sens-tu ?</label>
      <div class="chips">
        <label class="chip"><input type="checkbox" name="mood" value="Calme" onchange="giveAdvice()"> ğŸ™‚ Calme</label>
        <label class="chip"><input type="checkbox" name="mood" value="StressÃ©e" onchange="giveAdvice()"> ğŸ˜µ StressÃ©e</label>
        <label class="chip"><input type="checkbox" name="mood" value="FatiguÃ©e" onchange="giveAdvice()"> ğŸ˜´ FatiguÃ©e</label>
        <label class="chip"><input type="checkbox" name="mood" value="Sensible" onchange="giveAdvice()"> ğŸ¥º Sensible</label>
        <label class="chip"><input type="checkbox" name="mood" value="Sucre" onchange="giveAdvice()"> ğŸ« Envie de sucre</label>
      </div>

      <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
        <div>
          <label>Sommeil</label>
          <select id="sleep">
            <option value="bien">Bien dormi ğŸ˜´</option>
            <option value="moyen">Moyen</option>
            <option value="difficile">Difficile ğŸŒ™</option>
          </select>
        </div>
        <div>
          <label>Transit / Digestion</label>
          <select id="digestion" onchange="giveAdvice()">
            <option value="normal">Normal ğŸ‘</option>
            <option value="ballonnee">BallonnÃ©e ğŸˆ</option>
            <option value="diarrhee">DiarrhÃ©e ğŸ’¨</option>
            <option value="constipee">ConstipÃ©e ğŸ¢</option>
          </select>
        </div>
      </div>

      <label>Ovulation ressentie ?</label>
      <select id="hasOvu" onchange="toggleOvu(); giveAdvice();">
        <option value="non">Non / Pas encore</option>
        <option value="oui">Oui</option>
      </select>
      <div id="ovuBlock" style="display:none; border-left: 3px solid var(--green); padding-left:15px; margin-bottom:15px;">
        <label>Signes de ton corps</label>
        <div class="chips">
          <label class="chip"><input type="checkbox" name="ovuSymp" value="Tiraillements"> Tiraillements</label>
          <label class="chip"><input type="checkbox" name="ovuSymp" value="Douleurs"> Douleurs</label>
        </div>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px;">
          <div>
            <label>CÃ´tÃ© ?</label>
            <select id="ovuSide"><option value="?">?</option><option value="gauche">Gauche</option><option value="droite">Droite</option></select>
          </div>
          <div>
            <label>Pertes</label>
            <select id="ovuMucus"><option value="sec">Sec</option><option value="gluantes">Gluantes</option><option value="abondantes">Abondantes</option></select>
          </div>
        </div>
      </div>

      <label>Douleurs de rÃ¨gles aujourd'hui ?</label>
      <select id="hasPain" onchange="togglePain(); giveAdvice();">
        <option value="non">Non</option>
        <option value="oui">Oui</option>
      </select>
      <div id="painBlock" style="display:none; border-left: 3px solid var(--accent); padding-left:15px;">
        <label>IntensitÃ© (0 Ã  10)</label>
        <div class="scale" id="painScale" onchange="giveAdvice()"></div>
        <label>Zone de douleur</label>
        <div class="chips">
          <label class="chip"><input type="checkbox" name="where" value="Ventre"> Bas-ventre</label>
          <label class="chip"><input type="checkbox" name="where" value="Dos"> Dos</label>
        </div>
      </div>

      <div id="magicAdvice"></div>

      <label>Qu'as-tu utilisÃ© ?</label>
      <div class="chips">
        <label class="chip"><input type="checkbox" name="took" value="Bouillotte"> ğŸ”¥ Bouillotte</label>
        <label class="chip"><input type="checkbox" name="took" value="Djeka"> ğŸ«– Djeka/KhamarÃ©</label>
        <label class="chip"><input type="checkbox" name="took" value="Tisane"> ğŸŒ¼ Tisane</label>
        <label class="chip"><input type="checkbox" name="took" value="Rien"> ğŸ¤ Rien</label>
      </div>
      
      <label>Remarque libre</label>
      <textarea id="dailyNotes" placeholder="Raconte ta journÃ©e..."></textarea>
      
      <button class="btn-primary" onclick="addEntry()">Enregistrer ma note âœ¨</button>
    </div>
  </section>

  <aside>
    <div class="card">
      <h2>ğŸŒ¿ Solutions Naturo</h2>
      <div class="note">
        <b>DÃ¨s que j'ai mal :</b><br>
        â€¢ Bouillotte (bas-ventre ou bas du dos)<br>
        â€¢ Positions : foetus ou recroquevillÃ©e<br>
        â€¢ Respiration ventrale lente (2-3 min)
      </div>
      <div class="note2">
        <b>Djeka & KhamarÃ© :</b><br>
        â€¢ <b>PrÃ©vention :</b> 1 tasse/jour (3 j autour de l'ovulation) sur 3 cycles.<br>
        â€¢ <b>Crise :</b> 1 tasse dÃ¨s la douleur.<br>
        â€¢ <b>PrÃ©paration :</b> Rincer, bouillir 10 min, filtrer.
      </div>
      <div class="note">
        <b>Alimentation :</b><br>
        â€¢ Eau ++ et repas simples (riz, lÃ©gumes).<br>
        â€¢ Ã‰viter le sucre et l'ultra-transformÃ© si tu as mal.
      </div>
    </div>
    <div class="card">
      <h2>ğŸ“Š Historique</h2>
      <div id="ramadanStatus" class="note2" style="display:none;"></div>
      <div id="entriesList"></div>
      <button class="btn-ghost" onclick="clearAll()">Vider les donnÃ©es</button>
    </div>
  </aside>
</main>

<script>
const LS_KEY = "cycle_app_final_complete";
const scaleDiv = document.getElementById("painScale");
for(let i=0; i<=10; i++){ scaleDiv.innerHTML += `<input type="radio" name="pLvl" value="${i}" title="${i}" ${i===0?'checked':''}>`; }

function togglePain(){ document.getElementById("painBlock").style.display = (document.getElementById("hasPain").value === 'oui' ? 'block' : 'none'); }
function toggleOvu(){ document.getElementById("ovuBlock").style.display = (document.getElementById("hasOvu").value === 'oui' ? 'block' : 'none'); }
document.getElementById("ramadanMode").onchange = function(){ document.getElementById("ramadanFields").style.display = this.checked ? 'block' : 'none'; };

// --- LOGIQUE CONSEIL DYNAMIQUE ---
function giveAdvice() {
    const adviceDiv = document.getElementById("magicAdvice");
    let messages = [];

    const dig = document.getElementById("digestion").value;
    if(dig === "diarrhee") messages.push("ğŸ’¡ <b>Le savais-tu ?</b> La diarrhÃ©e pendant les rÃ¨gles est liÃ©e aux prostaglandines qui font contracter l'utÃ©rus et l'intestin. Bois bien de l'eau.");
    if(dig === "constipee") messages.push("ğŸ’¡ <b>Transit :</b> La constipation peut accentuer les douleurs. Favorise les fibres (lÃ©gumes) et l'eau pour aider l'Ã©vacuation des hormones.");

    const moods = Array.from(document.querySelectorAll('input[name="mood"]:checked')).map(e => e.value);
    if(moods.includes("StressÃ©e")) messages.push("âœ¨ <b>Zen :</b> Le stress consomme ton magnÃ©sium. Prends 2 min pour respirer lentement par le ventre.");
    if(moods.includes("Sucre")) messages.push("ğŸ« <b>Ã‰nergie :</b> Tes envies de sucre indiquent un besoin de rÃ©confort ou d'Ã©nergie. Un repas complet aide Ã  stabiliser Ã§a.");

    const pain = document.getElementById("hasPain").value;
    if(pain === "oui") {
        const lvl = document.querySelector('input[name="pLvl"]:checked').value;
        if(lvl >= 7) messages.push("ğŸ”¥ <b>AÃ¯e :</b> Douleur forte. Bouillotte + repos immÃ©diat. Si c'est ainsi chaque mois, parles-en Ã  un pro.");
    }

    const ovu = document.getElementById("hasOvu").value;
    if(ovu === "oui") messages.push("ğŸ¥š <b>Ovulation :</b> Les tiraillements sont normaux. C'est le bon moment pour ton infusion Djeka en prÃ©vention.");

    if(messages.length > 0) {
        adviceDiv.innerHTML = messages.join("<br><br>");
        adviceDiv.style.display = "block";
    } else {
        adviceDiv.style.display = "none";
    }
}

function getData(){ return JSON.parse(localStorage.getItem(LS_KEY) || '{"months":{}}'); }

function saveMonth(){
  const data = getData(); const m = document.getElementById("mainMonth").value; if(!m) return alert("Mois ?");
  data.months[m] = data.months[m] || { entries: [] };
  data.months[m].info = { start: document.getElementById("startDate").value, end: document.getElementById("endDate").value, ramActive: document.getElementById("ramadanMode").checked, ramTotal: document.getElementById("ramTotal").value, ramDone: document.getElementById("ramDone").value };
  localStorage.setItem(LS_KEY, JSON.stringify(data)); render(); alert("Dates du mois enregistrÃ©es !");
}

function addEntry(){
  const data = getData(); const m = document.getElementById("mainMonth").value; if(!m) return alert("Mois d'abord !");
  const entry = {
    id: Date.now(), date: document.getElementById("entryDate").value,
    moods: Array.from(document.querySelectorAll('input[name="mood"]:checked')).map(e=>e.value),
    sleep: document.getElementById("sleep").value, digestion: document.getElementById("digestion").value,
    ovu: { active: document.getElementById("hasOvu").value },
    pain: { active: document.getElementById("hasPain").value, lvl: document.querySelector('input[name="pLvl"]:checked').value },
    took: Array.from(document.querySelectorAll('input[name="took"]:checked')).map(e=>e.value),
    notes: document.getElementById("dailyNotes").value
  };
  data.months[m].entries.push(entry); localStorage.setItem(LS_KEY, JSON.stringify(data)); 
  render(); alert("Note enregistrÃ©e ! âœ¨");
}

function render(){
  const data = getData(); const m = document.getElementById("mainMonth").value; const list = document.getElementById("entriesList"); const rb = document.getElementById("ramadanStatus");
  list.innerHTML = ""; if(!data.months[m]) return;
  const info = data.months[m].info; if(info && info.ramActive){ rb.style.display="block"; const reste = (info.ramTotal||0) - (info.ramDone||0); rb.innerHTML = `ğŸŒ™ <b>Ramadan :</b> ${info.ramDone||0}/${info.ramTotal||0} faits. (Reste : ${reste}j)`; } else rb.style.display="none";
  data.months[m].entries.sort((a,b)=>new Date(b.date)-new Date(a.date)).forEach(e=>{
    const d = document.createElement("div"); d.className="entry";
    d.innerHTML = `<b>ğŸ“… ${e.date}</b><br><small>ğŸ’¤ ${e.sleep} | ğŸ¥— ${e.digestion}</small><br><small>ğŸŒ¿ Pris : ${e.took.join(', ') || 'Rien'}</small>`;
    list.appendChild(d);
  });
}
function clearAll(){ if(confirm("Effacer tout ?")){ localStorage.clear(); location.reload(); } }
const d = new Date(); document.getElementById("mainMonth").value = d.toISOString().slice(0,7);
document.getElementById("entryDate").value = d.toISOString().slice(0,10); render();
</script>
</body>
</html>
