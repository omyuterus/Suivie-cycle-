<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mon Suivi de Cycle ‚Äì Ado</title>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <style>
    :root{
      --bg:#fbf7f4;
      --card:#ffffff;
      --text:#1f2937;
      --muted:#6b7280;
      --accent:#a74d5e;     /* rose framboise */
      --accent2:#93b087;    /* vert sauge */
      --accent3:#244135;    /* vert fonc√© */
      --border:#eadfd7;
      --shadow: 0 10px 30px rgba(31,41,55,.08);
      --radius:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 600px at 10% 10%, rgba(167,77,94,.10), transparent 60%),
                  radial-gradient(1000px 500px at 90% 20%, rgba(147,176,135,.14), transparent 60%),
                  var(--bg);
      color:var(--text);
      min-height: 100vh;
    }
    header{
      padding:20px 16px 8px;
      max-width:980px;
      margin:0 auto;
    }
    .title{
      display:flex; gap:10px; align-items:center; flex-wrap:wrap;
    }
    .badge{
      font-size:12px;
      padding:6px 10px;
      border:1px solid var(--border);
      border-radius:999px;
      background:rgba(255,255,255,.7);
      color:var(--muted);
    }
    h1{
      margin:0;
      font-size:22px;
      letter-spacing:-.3px;
    }
    p.lead{
      margin:10px 0 0;
      color:var(--muted);
      line-height:1.45;
      max-width:78ch;
    }
    main{
      max-width:980px;
      margin:0 auto;
      padding:16px;
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap:16px;
    }
    @media (max-width: 900px){
      main{ grid-template-columns:1fr; }
    }
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:16px;
      height: fit-content;
    }
    .card h2{
      margin:0 0 10px;
      font-size:16px;
      color:var(--accent3);
    }
    .note{
      background: rgba(147,176,135,.10);
      border:1px dashed rgba(147,176,135,.55);
      color: #1f2937;
      padding:10px 12px;
      border-radius:14px;
      font-size:13px;
      line-height:1.35;
      margin:10px 0 14px;
    }
    form{
      display:grid;
      gap:12px;
    }
    label{
      font-size:13px;
      color:var(--muted);
      display:block;
      margin-bottom:6px;
    }
    input[type="text"], input[type="month"], input[type="date"], textarea, select{
      width:100%;
      padding:12px 12px;
      border:1px solid var(--border);
      border-radius:14px;
      outline:none;
      font-size:14px;
      background:#fff;
    }
    textarea{min-height:90px; resize:vertical}
    .row{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    @media (max-width:600px){
      .row{grid-template-columns:1fr}
    }
    .chips{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
    }
    .chip{
      display:flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      border:1px solid var(--border);
      border-radius:999px;
      background: rgba(255,255,255,.85);
      cursor:pointer;
      user-select:none;
      font-size:13px;
      color:var(--text);
    }
    .chip input{ accent-color: var(--accent); }
    .scale{
      display:grid;
      grid-template-columns: repeat(11, 1fr);
      gap:4px;
      align-items:center;
    }
    .scale input{
      width:100%;
      height:35px;
      border-radius:8px;
      border:1px solid var(--border);
      appearance:none;
      background:#fff;
      cursor:pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .scale input:checked{
      border:2px solid var(--accent);
      background: rgba(167,77,94,.1);
    }
    .scale input::before {
      content: attr(title);
      font-size: 10px;
      color: var(--muted);
    }
    .actions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:10px;
    }
    button{
      border:none;
      padding:12px 14px;
      border-radius:14px;
      cursor:pointer;
      font-weight:600;
      font-size:14px;
      transition: opacity 0.2s;
    }
    button:active{ opacity: 0.7; }
    .btn-primary{
      background:var(--accent);
      color:#fff;
    }
    .btn-secondary{
      background:rgba(147,176,135,.18);
      color:var(--accent3);
    }
    .btn-ghost{
      background:transparent;
      border:1px solid var(--border);
      color:var(--muted);
    }
    .small{
      font-size:12px;
      color:var(--muted);
      line-height:1.35;
      margin:8px 0 0;
    }
    .tabs{
      display:flex;
      gap:8px;
      margin-bottom:12px;
      flex-wrap:wrap;
    }
    .tab{
      padding:10px 12px;
      border-radius:999px;
      border:1px solid var(--border);
      background:#fff;
      cursor:pointer;
      font-size:13px;
      color:var(--muted);
    }
    .tab.active{
      color:var(--accent3);
      border-color: rgba(167,77,94,.35);
      background: rgba(167,77,94,.05);
    }
    .list{
      display:grid;
      gap:10px;
    }
    .entry{
      border:1px solid var(--border);
      border-radius:16px;
      padding:12px;
      background: rgba(251,247,244,.55);
    }
    .entry .meta{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-bottom:6px;
      color:var(--muted);
      font-size:12px;
    }
    .pill{
      padding:4px 8px;
      border-radius:999px;
      border:1px solid var(--border);
      background:#fff;
    }
    .entry .strong{
      font-weight:700;
      color:var(--accent3);
    }
    canvas{ width:100% !important; max-height:220px !important; }
  </style>
</head>

<body>
  <header>
    <div class="title">
      <h1>Mon suivi de cycle üåô</h1>
      <span class="badge">Confidentiel ¬∑ Enregistr√© localement</span>
    </div>
    <p class="lead">
      √âcoute ton corps √† ton rythme. Ces informations restent uniquement sur ton appareil.
    </p>
  </header>

  <main>
    <section class="card">
      <h2>üìå Remplir mon mois</h2>
      <div class="note">
        ‚úÖ Tes infos restent ici. Personne ne les voit, sauf si TU d√©cides de les montrer.
      </div>

      <form id="cycleForm">
        <div class="row">
          <div>
            <label for="month">Mois rempli</label>
            <input id="month" name="month" type="month" required />
          </div>
          <div>
            <label for="nickname">Pr√©nom / pseudo</label>
            <input id="nickname" name="nickname" type="text" placeholder="Optionnel" />
          </div>
        </div>

        <div class="row">
          <div>
            <label for="startDate">D√©but des r√®gles</label>
            <input id="startDate" name="startDate" type="date" required />
          </div>
          <div>
            <label for="endDate">Fin des r√®gles</label>
            <input id="endDate" name="endDate" type="date" required />
          </div>
        </div>

        <div>
          <label>Douleurs pendant les r√®gles ?</label>
          <select id="painYesNo" name="painYesNo" required>
            <option value="" selected disabled>Choisir‚Ä¶</option>
            <option value="oui">Oui</option>
            <option value="non">Non</option>
          </select>
        </div>

        <div id="painDetails" style="display:none;">
          <label>O√π as-tu eu mal ? (plusieurs choix possibles)</label>
          <div class="chips">
            <label class="chip"><input type="checkbox" name="painWhere" value="Bas-ventre"> Bas-ventre</label>
            <label class="chip"><input type="checkbox" name="painWhere" value="Dos / reins"> Dos / reins</label>
            <label class="chip"><input type="checkbox" name="painWhere" value="Entre les jambes"> Entre les jambes</label>
            <label class="chip"><input type="checkbox" name="painWhere" value="Autre"> Autre</label>
          </div>

          <div style="margin-top:10px;">
            <label>Intensit√© (0 = rien, 10 = tr√®s fort)</label>
            <div class="scale" id="painScale"></div>
          </div>
        </div>

        <div>
          <label>Ce qui t'a aid√©e (plusieurs choix possibles)</label>
          <div class="chips">
            <label class="chip"><input type="checkbox" name="helpUsed" value="Chaleur / bouillotte"> üî• Bouillotte</label>
            <label class="chip"><input type="checkbox" name="helpUsed" value="Camomille"> üåº Camomille</label>
            <label class="chip"><input type="checkbox" name="helpUsed" value="M√©lisse"> üçÉ M√©lisse</label>
            <label class="chip"><input type="checkbox" name="helpUsed" value="Verveine"> üåø Verveine</label>
            <label class="chip"><input type="checkbox" name="helpUsed" value="Djeka / khamar√©"> ü´ñ Djeka / khamar√©</label>
            <label class="chip"><input type="checkbox" name="helpUsed" value="Rien"> ü§ç Rien</label>
          </div>
        </div>

        <div>
          <label>Comment t'es-tu sentie la semaine AVANT ?</label>
          <div class="chips">
            <label class="chip"><input type="checkbox" name="mood" value="Calme"> üôÇ Calme</label>
            <label class="chip"><input type="checkbox" name="mood" value="Stress√©e"> üòµ Stress√©e</label>
            <label class="chip"><input type="checkbox" name="mood" value="Fatigu√©e"> üò¥ Fatigu√©e</label>
            <label class="chip"><input type="checkbox" name="mood" value="Irritable"> üò§ Irritable</label>
            <label class="chip"><input type="checkbox" name="mood" value="Sensible"> ü•∫ Sensible</label>
          </div>
        </div>

        <div>
          <label for="notes">Notes libres (facultatif)</label>
          <textarea id="notes" name="notes" placeholder="Sommeil, envies de sucre, sport..."></textarea>
        </div>

        <div class="actions">
          <button class="btn-primary" type="submit">Enregistrer mon mois ‚ú®</button>
          <button class="btn-ghost" type="button" id="resetFormBtn">Vider</button>
        </div>
      </form>
    </section>

    <aside class="card">
      <h2>üìä Mon r√©capitulatif</h2>
      <div class="tabs">
        <button class="tab active" data-tab="overview" type="button">Graphiques</button>
        <button class="tab" data-tab="entries" type="button">Historique</button>
      </div>

      <div id="tab-overview">
        <canvas id="painChart"></canvas>
        <div style="height:15px"></div>
        <canvas id="durationChart"></canvas>
      </div>

      <div id="tab-entries" style="display:none;">
        <div class="list" id="entriesList"></div>
        <div class="actions" style="margin-top:20px;">
          <button class="btn-secondary" type="button" id="exportBtn">Exporter (JSON)</button>
          <button class="btn-ghost" type="button" id="clearAllBtn" style="color:#dc2626">Tout supprimer</button>
        </div>
      </div>
    </aside>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script>
    const LS_KEY = "cycle_entries_v1";

    function loadEntries(){
      try { return JSON.parse(localStorage.getItem(LS_KEY) || "[]"); }
      catch { return []; }
    }
    function saveEntries(entries){
      localStorage.setItem(LS_KEY, JSON.stringify(entries));
    }

    // Build pain scale 0..10
    const painScale = document.getElementById("painScale");
    for(let i=0; i<=10; i++){
      const input = document.createElement("input");
      input.type = "radio";
      input.name = "painLevel";
      input.value = String(i);
      input.title = String(i);
      if(i===0) input.checked = true;
      painScale.appendChild(input);
    }

    // Show/hide pain details
    const painYesNo = document.getElementById("painYesNo");
    const painDetails = document.getElementById("painDetails");
    painYesNo.addEventListener("change", () => {
      painDetails.style.display = (painYesNo.value === "oui") ? "block" : "none";
    });

    // Default month
    const monthInput = document.getElementById("month");
    const now = new Date();
    monthInput.value = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,"0")}`;

    // Charts
    let painChart, durationChart;

    function buildCharts(entries){
      const sorted = [...entries].sort((a,b)=> a.month.localeCompare(b.month));
      const labels = sorted.map(e => e.month);
      const pains = sorted.map(e => e.painLevel);
      const durations = sorted.map(e => e.durationDays);

      if(painChart) painChart.destroy();
      if(durationChart) durationChart.destroy();

      const commonOptions = { responsive: true, plugins: { legend: { display: true } } };

      painChart = new Chart(document.getElementById("painChart"), {
        type: "line",
        data: { labels, datasets: [{ label: "Intensit√© Douleur", data: pains, borderColor: "#a74d5e", tension: 0.3 }] },
        options: { ...commonOptions, scales: { y: { min:0, max:10 } } }
      });

      durationChart = new Chart(document.getElementById("durationChart"), {
        type: "bar",
        data: { labels, datasets: [{ label: "Jours de r√®gles", data: durations, backgroundColor: "#93b087" }] },
        options: commonOptions
      });
    }

    function renderEntries(entries){
      const list = document.getElementById("entriesList");
      list.innerHTML = entries.length === 0 ? "<p>Aucun mois enregistr√©.</p>" : "";
      
      [...entries].sort((a,b)=> b.month.localeCompare(a.month)).forEach(e => {
        const div = document.createElement("div");
        div.className = "entry";
        div.innerHTML = `
          <div class="meta"><span class="pill">üìÖ ${e.month}</span> <span class="pill">ü©∏ ${e.durationDays}j</span></div>
          <div class="strong">Douleur : ${e.painLevel}/10</div>
          <div style="font-size:13px">${e.notes || ""}</div>
          <button class="btn-ghost" style="font-size:11px; margin-top:8px" onclick="deleteEntry('${e.id}')">Supprimer</button>
        `;
        list.appendChild(div);
      });
    }

    window.deleteEntry = (id) => {
      if(confirm("Supprimer ce mois ?")){
        const entries = loadEntries().filter(e => e.id !== id);
        saveEntries(entries);
        refreshUI();
      }
    };

    function refreshUI(){
      const entries = loadEntries();
      buildCharts(entries);
      renderEntries(entries);
    }

    // Tabs logic
    document.querySelectorAll(".tab").forEach(tab => {
      tab.addEventListener("click", () => {
        document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));
        tab.classList.add("active");
        const name = tab.getAttribute("data-tab");
        document.getElementById("tab-overview").style.display = name === "overview" ? "block" : "none";
        document.getElementById("tab-entries").style.display = name === "entries" ? "block" : "none";
      });
    });

    // Form Submit
    document.getElementById("cycleForm").addEventListener("submit", (ev) => {
      ev.preventDefault();
      const fd = new FormData(ev.target);
      const start = new Date(fd.get("startDate"));
      const end = new Date(fd.get("endDate"));
      const diff = Math.round((end - start) / (1000*60*60*24)) + 1;

      const entry = {
        id: Date.now().toString(),
        month: fd.get("month"),
        durationDays: diff > 0 ? diff : 0,
        painLevel: fd.get("painYesNo") === "oui" ? parseInt(document.querySelector('input[name="painLevel"]:checked').value) : 0,
        notes: fd.get("notes"),
        mood: Array.from(document.querySelectorAll('input[name="mood"]:checked')).map(i => i.value)
      };

      const entries = loadEntries();
      entries.push(entry);
      saveEntries(entries);
      ev.target.reset();
      refreshUI();
      alert("C'est enregistr√© ! ‚ú®");
    });

    document.getElementById("exportBtn").addEventListener("click", () => {
      const blob = new Blob([JSON.stringify(loadEntries(), null, 2)], {type: "application/json"});
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "mon-suivi-cycle.json";
      a.click();
    });

    document.getElementById("clearAllBtn").addEventListener("click", () => {
      if(confirm("Tout effacer d√©finitivement ?")) { localStorage.removeItem(LS_KEY); refreshUI(); }
    });

    document.getElementById("resetFormBtn").addEventListener("click", () => {
        document.getElementById("cycleForm").reset();
        painDetails.style.display = "none";
    });

    refreshUI();
  </script>
</body>
          </html>
          
