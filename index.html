<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Mon suivi du cycle</title>

  <!-- FAVICONS -->
  <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32.png">
  <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192.png">
  <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#a74d5e">

  <style>
    :root{
      --bg:#fbf7f4;
      --card:#ffffff;
      --text:#1f2937;
      --muted:#6b7280;
      --accent:#a74d5e;
      --green:#93b087;
      --dark:#244135;
      --border:#eadfd7;
      --radius:18px;
      --shadow:0 10px 30px rgba(0,0,0,.08);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui,-apple-system,Segoe UI,Roboto;
      background:var(--bg);
      color:var(--text);
    }
    header{
      max-width:1100px;
      margin:auto;
      padding:20px;
    }
    h1{margin:0;font-size:22px}
    .badge{
      display:inline-block;
      margin-top:6px;
      font-size:12px;
      padding:6px 10px;
      border:1px solid var(--border);
      border-radius:999px;
      background:#fff;
      color:var(--muted);
    }
    main{
      max-width:1100px;
      margin:auto;
      padding:16px;
      display:grid;
      grid-template-columns:1.1fr .9fr;
      gap:16px;
    }
    @media(max-width:900px){main{grid-template-columns:1fr}}
    .card{
      background:#fff;
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:16px;
      box-shadow:var(--shadow);
    }
    h2{margin-top:0;color:var(--dark)}
    label{font-size:13px;color:var(--muted)}
    input,select,textarea,button{
      width:100%;
      padding:12px;
      margin-top:6px;
      border-radius:14px;
      border:1px solid var(--border);
      font-size:14px;
    }
    textarea{resize:vertical}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    @media(max-width:600px){.row{grid-template-columns:1fr}}
    button{
      cursor:pointer;
      font-weight:700;
      border:none;
    }
    .btn-primary{background:var(--accent);color:#fff}
    .btn-secondary{background:#93b08733;color:var(--dark)}
    .note{
      background:#93b08722;
      border:1px dashed #93b087;
      padding:12px;
      border-radius:14px;
      font-size:13px;
      margin-bottom:12px;
    }
    .note2{
      background:#a74d5e22;
      border:1px dashed #a74d5e;
      padding:12px;
      border-radius:14px;
      font-size:13px;
      margin-bottom:12px;
    }
    .chips{display:flex;flex-wrap:wrap;gap:8px}
    .chip{
      padding:10px 14px;
      border-radius:999px;
      border:1px solid var(--border);
      background:#fff;
      font-size:13px;
      display:flex;
      align-items:center;
      gap:6px;
    }
    .scale{
      display:grid;
      grid-template-columns:repeat(11,1fr);
      gap:6px;
      margin-top:6px;
    }
    .scale input{
      height:36px;
      border-radius:10px;
      border:1px solid var(--border);
      appearance:none;
      cursor:pointer;
    }
    .scale input:checked{
      border:2px solid var(--accent);
      background:#a74d5e22;
    }
    .divider{height:1px;background:#eadfd7;margin:14px 0}
  </style>
</head>

<body>

<header>
  <h1>ğŸŒ™ Mon suivi du cycle</h1>
  <div class="badge">Confidentiel â€¢ reste sur ton tÃ©lÃ©phone</div>
</header>

<main>   
  <!-- COLONNE GAUCHE -->
  <section class="card">
    <h2>ğŸ©· Mon suivi du mois</h2>

    <div class="note">
      âœ… Tu peux noter <b>tous les jours</b> si tu veux.<br>
      âœ… Tu peux modifier ton mois <b>Ã  tout moment</b>.<br>
      âœ… Personne ne voit : câ€™est enregistrÃ© sur <b>ton appareil</b>.
    </div>

    <form id="monthForm">

      <div class="row">
        <div>
          <label for="month">Mois</label>
          <input id="month" type="month" required>
        </div>
        <div>
          <label for="nickname">PrÃ©nom / pseudo (facultatif)</label>
          <input id="nickname" type="text" placeholder="ex : Lina / Lili / ğŸŒ¸">
        </div>
      </div>

      <div class="row">
        <div>
          <label for="startDate">DÃ©but des rÃ¨gles</label>
          <input id="startDate" type="date">
        </div>
        <div>
          <label for="endDate">Fin des rÃ¨gles</label>
          <input id="endDate" type="date">
        </div>
      </div>

      <div class="note2">
        <b>ğŸŒ™ Ramadan (manuel)</b><br>
        MÃªme si tu utilises lâ€™outil aprÃ¨s Ramadan : tu peux Ã©crire ton total + ton avancÃ©e.
      </div>

      <div class="row">
        <div>
          <label class="chip" style="width:100%;justify-content:center;">
            <input type="checkbox" id="ramadan">
            Jâ€™ai des jours Ã  rattraper (Ramadan)
          </label>
        </div>
        <div>
          <label for="ramadanTotal">Total de jours Ã  rattraper</label>
          <input id="ramadanTotal" type="number" min="0" step="1" placeholder="ex : 6">
        </div>
      </div>

      <div class="row">
        <div>
          <label for="ramadanDone">Jours dÃ©jÃ  rattrapÃ©s</label>
          <input id="ramadanDone" type="number" min="0" step="1" placeholder="ex : 2">
        </div>
        <div>
          <label for="ramadanRemaining">Jours restants</label>
          <input id="ramadanRemaining" type="text" disabled>
        </div>
      </div>

      <div class="note2" id="monthStatusBox"></div>

      <div class="row">
        <button class="btn-secondary" type="button" id="saveMonthBtn">Enregistrer / mettre Ã  jour le mois</button>
        <button type="button" id="exportMonthBtn">ğŸ“„ Export rÃ©sumÃ© (texte)</button>
      </div>

      <div class="divider"></div>

      <h2 style="margin-bottom:6px;">â• Ajouter une entrÃ©e</h2>
      <div class="note">
        Une entrÃ©e = tu notes un moment de ta journÃ©e (douleur, ovulation, humeur, plantesâ€¦).<br>
        Tu peux en faire <b>autant que tu veux</b>.
      </div>

      <div class="row">
        <div>
          <label for="entryDate">Date</label>
          <input id="entryDate" type="date" required>
        </div>
        <div>
          <label for="entryType">Type</label>
          <select id="entryType" required>
            <option value="" selected disabled>Choisirâ€¦</option>
            <option value="ovulation">Ovulation / signes</option>
            <option value="regles">RÃ¨gles / douleur</option>
            <option value="spm">SPM / humeur / stress</option>
            <option value="plantes">Plantes prises</option>
            <option value="alimentation">Alimentation (simple)</option>
            <option value="note">Note libre</option>
          </select>
        </div>
      </div>

      <!-- OVULATION -->
      <div id="ovulationBlock" style="display:none;">
        <label>Ovulation : signes</label>
        <div class="chips">
          <label class="chip"><input type="checkbox" name="ovuSigns" value="Tiraillement ovaire"> Tiraillement ovaire</label>
          <label class="chip"><input type="checkbox" name="ovuSigns" value="Pertes plus gluantes"> Pertes plus gluantes</label>
          <label class="chip"><input type="checkbox" name="ovuSigns" value="Pertes plus abondantes"> Pertes plus abondantes</label>
          <label class="chip"><input type="checkbox" name="ovuSigns" value="Ã‰nergie diffÃ©rente"> Ã‰nergie diffÃ©rente</label>
        </div>

        <div class="row" style="margin-top:10px;">
          <div>
            <label>Si tiraillement : cÃ´tÃ© ?</label>
            <select id="ovuSide">
              <option value="" selected>Je ne sais pas / pas ressenti</option>
              <option value="gauche">Gauche</option>
              <option value="droite">Droite</option>
            </select>
          </div>
          <div>
            <label>Pertes : aspect</label>
            <select id="mucusType">
              <option value="" selected>Je ne sais pas</option>
              <option value="crÃ©meux">CrÃ©meux / blanc</option>
              <option value="gluant">Gluant / â€œblanc dâ€™Å“ufâ€</option>
              <option value="aqueux">Aqueux</option>
              <option value="sec">Sec / peu</option>
            </select>
          </div>
        </div>
      </div>

      <!-- DOULEUR OUI/NON -->
      <div id="painBlock" style="display:none;">
        <label>As-tu eu mal aujourdâ€™hui ?</label>
        <div class="chips">
          <label class="chip"><input type="radio" name="painYesNo" value="oui"> Oui</label>
          <label class="chip"><input type="radio" name="painYesNo" value="non"> Non</label>
        </div>

        <div id="painDetails" style="display:none; margin-top:10px;">
          <label>Si oui : oÃ¹ ?</label>
          <div class="chips">
            <label class="chip"><input type="checkbox" name="painWhere" value="Bas-ventre"> Bas-ventre</label>
            <label class="chip"><input type="checkbox" name="painWhere" value="Dos / reins"> Dos / reins</label>
            <label class="chip"><input type="checkbox" name="painWhere" value="Entre les jambes"> Entre les jambes</label>
            <label class="chip"><input type="checkbox" name="painWhere" value="Autre"> Autre</label>
          </div>

          <label style="margin-top:10px;display:block;">IntensitÃ© (0â€“10)</label>
          <div class="scale" id="painScale"></div>
        </div>
      </div>

      <!-- SPM -->
      <div id="spmBlock" style="display:none;">
        <label>Humeur / SPM (tu peux cocher plusieurs)</label>
        <div class="chips">
          <label class="chip"><input type="checkbox" name="mood" value="Calme"> ğŸ™‚ Calme</label>
          <label class="chip"><input type="checkbox" name="mood" value="StressÃ©e"> ğŸ˜µ StressÃ©e</label>
          <label class="chip"><input type="checkbox" name="mood" value="FatiguÃ©e"> ğŸ˜´ FatiguÃ©e</label>
          <label class="chip"><input type="checkbox" name="mood" value="Irritable"> ğŸ˜¤ Irritable</label>
          <label class="chip"><input type="checkbox" name="mood" value="Sensible"> ğŸ¥º Sensible</label>
          <label class="chip"><input type="checkbox" name="mood" value="Envie de sucre"> ğŸ« Envie de sucre</label>
          <label class="chip"><input type="checkbox" name="mood" value="Ballonnements"> ğŸˆ Ballonnements</label>
          <label class="chip"><input type="checkbox" name="mood" value="Maux de tÃªte"> ğŸ¤• Maux de tÃªte</label>
        </div>
      </div>

      <!-- PLANTES -->
      <div id="plantsBlock" style="display:none;">
        <label>Plantes prises aujourdâ€™hui</label>
        <div class="chips">
          <label class="chip"><input type="checkbox" name="plants" value="Camomille"> ğŸŒ¼ Camomille</label>
          <label class="chip"><input type="checkbox" name="plants" value="MÃ©lisse"> ğŸƒ MÃ©lisse</label>
          <label class="chip"><input type="checkbox" name="plants" value="Verveine"> ğŸŒ¿ Verveine</label>
          <label class="chip"><input type="checkbox" name="plants" value="Djeka"> ğŸ«– Djeka</label>
          <label class="chip"><input type="checkbox" name="plants" value="KhamarÃ©"> ğŸ«– KhamarÃ©</label>
        </div>

        <div class="row" style="margin-top:10px;">
          <div>
            <label>Combien de tasses ?</label>
            <select id="cups">
              <option value="0" selected>0</option>
              <option value="1">1</option>
              <option value="2">2</option>
            </select>
          </div>
          <div>
            <label>Moment</label>
            <select id="whenCups">
              <option value="" selected>â€”</option>
              <option value="matin">Matin</option>
              <option value="aprÃ¨s-midi">AprÃ¨s-midi</option>
              <option value="soir">Soir</option>
              <option value="dÃ¨s la douleur">DÃ¨s la douleur</option>
            </select>
          </div>
        </div>
      </div>

      <!-- ALIMENTATION -->
      <div id="foodBlock" style="display:none;">
        <label>Alimentation (simple, sans jugement)</label>
        <div class="chips">
          <label class="chip"><input type="checkbox" name="food" value="Jâ€™ai bu de lâ€™eau"> ğŸ’§ Jâ€™ai bu de lâ€™eau</label>
          <label class="chip"><input type="checkbox" name="food" value="PlutÃ´t maison"> ğŸ² PlutÃ´t maison</label>
          <label class="chip"><input type="checkbox" name="food" value="Fast-food / ultra transformÃ©"> ğŸŸ Fast-food / ultra transformÃ©</label>
          <label class="chip"><input type="checkbox" name="food" value="Beaucoup de sucre"> ğŸ« Beaucoup de sucre</label>
          <label class="chip"><input type="checkbox" name="food" value="Fruits / lÃ©gumes"> ğŸ Fruits / lÃ©gumes</label>
        </div>
      </div>

      <!-- CONSEIL DYNAMIQUE -->
      <div class="note2" id="adviceBox" style="display:none;"></div>

      <div>
        <label for="entryNotes">Note libre (facultatif)</label>
        <textarea id="entryNotes" placeholder="ex : journÃ©e stressante / mauvaise nuit / jâ€™ai pris 1 tasseâ€¦"></textarea>
      </div>

      <div class="row">
        <button class="btn-primary" type="button" id="addEntryBtn">Enregistrer cette entrÃ©e âœ¨</button>
        <button type="button" id="clearEntryBtn">Vider lâ€™entrÃ©e</button>
      </div>

      <div class="note" style="margin-top:10px;">
        âš ï¸ Si douleur trÃ¨s forte, malaise, vomissements, rÃ¨gles trÃ¨s abondantes â†’ parle Ã  un adulte + consulte.
      </div>

    </form>
  </section>

  <!-- COLONNE DROITE -->
  <aside class="card">
    <h2>ğŸ§° Mes solutions (toujours au mÃªme endroit)</h2>

    <div class="note">
      <b>Quand jâ€™ai mal LÃ€, tout de suite :</b><br>
      â€¢ <b>Bouillotte / chaleur</b> (bas-ventre ou bas du dos) 15â€“20 min, tu peux recommencer.<br>
      â€¢ <b>Positions</b> : sur le cÃ´tÃ© genoux repliÃ©s / recroquevillÃ©e / posture â€œbÃ©bÃ©â€.<br>
      â€¢ <b>Respiration</b> : inspire 4 sec â†’ expire 6 sec, pendant 2â€“3 minutes.<br>
      â€¢ <b>Eau</b> + petit truc Ã  manger si tu as rien dans le ventre (banane / dattes / tartine).<br>
      <span style="color:#6b7280;font-size:12px;">Objectif : calmer le systÃ¨me nerveux + dÃ©tendre lâ€™utÃ©rus.</span>
    </div>

    <div class="note2">
      <b>Ce quâ€™on entend souventâ€¦ et ce que je veux que tu retiennes :</b><br>
      â€¢ â€œCâ€™est normal dâ€™avoir malâ€ â†’ <b>non</b>, câ€™est frÃ©quent mais pas obligatoire.<br>
      â€¢ â€œPrends un Spasfon et tais-toiâ€ â†’ Ã§a aide parfois, mais <b>Ã§a ne rÃ¨gle pas la cause</b>.<br>
      â€¢ La douleur = un <b>signal</b>. On observe, on comprend, et on aide le corps Ã  se rÃ©guler.
    </div>

    <div class="note">
      <b>Plantes douces (stress/SPM) â€” semaine AVANT les rÃ¨gles :</b><br>
      <b>Camomille / MÃ©lisse / Verveine</b><br>
      â€¢ <b>Quand ?</b> le soir, ou dÃ¨s que tu sens que tu es plus tendue / irritable / fatiguÃ©e.<br>
      â€¢ <b>Combien ?</b> 1 tasse/jour (tu peux monter Ã  2 si besoin).<br>
      â€¢ <b>Comment ?</b> infusion 5â€“10 min.<br>
      â€¢ <b>Pourquoi ?</b> Ã§a aide le stress + le sommeil â†’ et souvent Ã§a calme le SPM.
    </div>

    <div class="note2">
      <b>Djeka & KhamarÃ© (prÃ©vention + douleur) :</b><br>
      <b>PrÃ©paration</b> : rincer â†’ casserole dâ€™eau â†’ <b>bouillir 10 minutes</b> â†’ filtrer.<br>
      â€¢ Tu peux boire <b>chaud</b> ou <b>froid</b> (mais la dÃ©coction = obligatoire).<br>
      â€¢ <b>RÃ©utilisable 2 fois</b> (2 dÃ©coctions max).<br><br>

      <b>PrÃ©vention</b> : 1 tasse/jour pendant <b>3 jours autour de lâ€™ovulation</b> â†’ pendant <b>3 cycles</b>, puis pause.<br>
      <b>Instant T</b> : 1 tasse dÃ¨s que la douleur arrive â†’ souvent Ã§a calme vite sur le moment.
    </div>

    <div class="note">
      <b>Alimentation â€œanti-inflammatoireâ€ (sans te priver) :</b><br>
      â€¢ Si tu as mal : rÃ©duis un peu <b>sucre</b> + <b>ultra-transformÃ©</b> 2â€“3 jours.<br>
      â€¢ Ajoute : <b>eau</b> + repas simple + fruits/lÃ©gumes.<br>
      â€¢ Oui tu peux manger un tacos ğŸ˜„ mais ton corps dit merci quand tu Ã©quilibres.<br>
      â€¢ Plus ton corps est â€œchargÃ©â€ (sucre + stress + fatigue), plus il peut Ãªtre en mode <b>inflammation</b>.
    </div>

    <div class="divider"></div>

    <h2>ğŸ“Š RÃ©cap & Graphiques</h2>

    <div style="display:flex;gap:8px;margin-bottom:10px;">
      <button type="button" class="btn-secondary" id="tabGraph">Graphiques</button>
      <button type="button" id="tabMonth">Mois</button>
      <button type="button" id="tabHistory">Historique</button>
    </div>

    <div id="panelGraph">
      <canvas id="painChart"></canvas>
      <div style="height:10px;"></div>
      <canvas id="durationChart"></canvas>
    </div>

    <div id="panelMonth" style="display:none;">
      <div class="note" id="currentMonthBox"></div>
      <div id="currentEntriesList"></div>
    </div>

    <div id="panelHistory" style="display:none;">
      <div class="row" style="margin-bottom:10px;">
        <button class="btn-secondary" type="button" id="exportBtn">Exporter (JSON)</button>
        <button type="button" id="clearAllBtn">Tout supprimer</button>
      </div>
      <div id="monthsList"></div>
    </div>

  </aside>
</main>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script>
  const LS_KEY = "cycle_months_full_v1";

  const monthInput = document.getElementById("month");
  const nicknameInput = document.getElementById("nickname");
  const startDateInput = document.getElementById("startDate");
  const endDateInput = document.getElementById("endDate");

  const ramadanInput = document.getElementById("ramadan");
  const ramadanTotalInput = document.getElementById("ramadanTotal");
  const ramadanDoneInput = document.getElementById("ramadanDone");
  const ramadanRemainingInput = document.getElementById("ramadanRemaining");

  const statusBox = document.getElementById("monthStatusBox");
  const saveMonthBtn = document.getElementById("saveMonthBtn");
  const exportMonthBtn = document.getElementById("exportMonthBtn");

  const entryDate = document.getElementById("entryDate");
  const entryType = document.getElementById("entryType");
  const entryNotes = document.getElementById("entryNotes");

  const ovulationBlock = document.getElementById("ovulationBlock");
  const painBlock = document.getElementById("painBlock");
  const painDetails = document.getElementById("painDetails");
  const spmBlock = document.getElementById("spmBlock");
  const plantsBlock = document.getElementById("plantsBlock");
  const foodBlock = document.getElementById("foodBlock");

  const ovuSide = document.getElementById("ovuSide");
  const mucusType = document.getElementById("mucusType");
  const cups = document.getElementById("cups");
  const whenCups = document.getElementById("whenCups");

  const adviceBox = document.getElementById("adviceBox");

  const addEntryBtn = document.getElementById("addEntryBtn");
  const clearEntryBtn = document.getElementById("clearEntryBtn");

  // Tabs
  const tabGraph = document.getElementById("tabGraph");
  const tabMonth = document.getElementById("tabMonth");
  const tabHistory = document.getElementById("tabHistory");
  const panelGraph = document.getElementById("panelGraph");
  const panelMonth = document.getElementById("panelMonth");
  const panelHistory = document.getElementById("panelHistory");

  tabGraph.onclick = () => { panelGraph.style.display="block"; panelMonth.style.display="none"; panelHistory.style.display="none"; };
  tabMonth.onclick = () => { panelGraph.style.display="none"; panelMonth.style.display="block"; panelHistory.style.display="none"; };
  tabHistory.onclick = () => { panelGraph.style.display="none"; panelMonth.style.display="none"; panelHistory.style.display="block"; };

  function loadMonths(){ try { return JSON.parse(localStorage.getItem(LS_KEY) || "[]"); } catch { return []; } }
  function saveMonths(data){ localStorage.setItem(LS_KEY, JSON.stringify(data)); }

  function daysBetween(start, end){
    if(!start || !end) return 0;
    const s = new Date(start), e = new Date(end);
    const diff = (e - s)/(1000*60*60*24);
    return Number.isFinite(diff) ? Math.max(0, Math.round(diff)+1) : 0;
  }

  function getCheckedValues(name){
    return Array.from(document.querySelectorAll(`input[name="${name}"]:checked`)).map(x=>x.value);
  }

  // Default month + date
  const now = new Date();
  monthInput.value = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,"0")}`;
  entryDate.valueAsDate = new Date();

  // Scale 0..10
  const painScale = document.getElementById("painScale");
  for(let i=0;i<=10;i++){
    const r = document.createElement("input");
    r.type="radio"; r.name="painLevel"; r.value=String(i);
    painScale.appendChild(r);
  }

  function renderRamadanRemaining(){
    if(!ramadanInput.checked){
      ramadanRemainingInput.value="â€”";
      ramadanTotalInput.disabled=true;
      ramadanDoneInput.disabled=true;
      return;
    }
    ramadanTotalInput.disabled=false;
    ramadanDoneInput.disabled=false;
    const total = Math.max(0, Number(ramadanTotalInput.value||0));
    const done = Math.max(0, Number(ramadanDoneInput.value||0));
    ramadanRemainingInput.value = `${Math.max(0,total-done)} jour(s)`;
  }
  ramadanInput.onchange = renderRamadanRemaining;
  ramadanTotalInput.oninput = renderRamadanRemaining;
  ramadanDoneInput.oninput = renderRamadanRemaining;

  function upsertMonth(month, patch){
    const months = loadMonths();
    const i = months.findIndex(m=>m.month===month);
    if(i>=0) months[i] = { ...months[i], ...patch };
    else months.push({ month, entries:[], ...patch });
    saveMonths(months);
  }
  function getMonthObj(month){
    return loadMonths().find(m=>m.month===month) || null;
  }
  function addEntryToMonth(month, entry){
    const months = loadMonths();
    const i = months.findIndex(m=>m.month===month);
    if(i<0){
      upsertMonth(month, readMonthFields());
      return addEntryToMonth(month, entry);
    }
    months[i].entries.push(entry);
    saveMonths(months);
  }
  function deleteEntry(month, id){
    const months = loadMonths();
    const i = months.findIndex(m=>m.month===month);
    if(i<0) return;
    months[i].entries = months[i].entries.filter(e=>e.id!==id);
    saveMonths(months);
  }

  function readMonthFields(){
    const ram = !!ramadanInput.checked;
    return {
      nickname: nicknameInput.value.trim() || null,
      startDate: startDateInput.value || null,
      endDate: endDateInput.value || null,
      ramadan: ram,
      ramadanTotal: ram ? Math.max(0, Number(ramadanTotalInput.value||0)) : 0,
      ramadanDone: ram ? Math.max(0, Number(ramadanDoneInput.value||0)) : 0
    };
  }

  function renderMonthStatus(){
    const m = getMonthObj(monthInput.value);
    if(!m){
      statusBox.innerHTML = `ğŸŸ¡ <b>${monthInput.value}</b> : pas encore enregistrÃ©.`;
      return;
    }
    const dur = daysBetween(m.startDate, m.endDate);
    const ram = m.ramadan ? `ğŸŒ™ Ramadan : total <b>${m.ramadanTotal}</b> Â· rattrapÃ©s <b>${m.ramadanDone}</b> Â· reste <b>${Math.max(0,m.ramadanTotal-m.ramadanDone)}</b>` : "ğŸŒ™ Ramadan : non";
    statusBox.innerHTML = `ğŸ“… <b>${m.month}</b> â€¢ ğŸ©¸ <b>${dur||0}</b> jours â€¢ ğŸ—‚ï¸ <b>${(m.entries||[]).length}</b> entrÃ©es<br>${ram}`;
  }

  function syncMonthFromStorage(){
    const m = getMonthObj(monthInput.value);
    if(!m){
      startDateInput.value="";
      endDateInput.value="";
      ramadanInput.checked=false;
      ramadanTotalInput.value="";
      ramadanDoneInput.value="";
      renderRamadanRemaining();
      renderMonthStatus();
      refreshUI();
      return;
    }
    nicknameInput.value = m.nickname || 
